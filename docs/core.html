<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">

    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>core package &mdash; ResNet Builder v1.1 documentation</title>


    <script src="_static/js/modernizr.min.js" type="text/javascript"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"
            type="text/javascript"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>

    <script src="_static/js/theme.js" type="text/javascript"></script>


    <link href="_static/css/theme.css" rel="stylesheet" type="text/css"/>
    <link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
    <link href="genindex.html" rel="index" title="Index"/>
    <link href="search.html" rel="search" title="Search"/>
    <link href="inference.html" rel="next" title="inference module"/>
    <link href="modules.html" rel="prev" title="ResNet-builder"/>
</head>

<body class="wy-body-for-nav">


<div class="wy-grid-for-nav">

    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">


                <a class="icon icon-home" href="index.html"> ResNet Builder


                </a>


                <div role="search">
                    <form action="search.html" class="wy-form" id="rtd-search-form" method="get">
                        <input name="q" placeholder="Search docs" type="text"/>
                        <input name="check_keywords" type="hidden" value="yes"/>
                        <input name="area" type="hidden" value="default"/>
                    </form>
                </div>


            </div>

            <div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">


                <p class="caption"><span class="caption-text">Contents:</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal" href="modules.html">ResNet-builder</a>
                        <ul class="current">
                            <li class="toctree-l2 current"><a class="current reference internal" href="#">core
                                package</a>
                                <ul>
                                    <li class="toctree-l3"><a class="reference internal"
                                                              href="#submodules">Submodules</a></li>
                                    <li class="toctree-l3"><a class="reference internal"
                                                              href="#module-core.data_loader">core.data_loader
                                        module</a></li>
                                    <li class="toctree-l3"><a class="reference internal" href="#module-core.resnet">core.resnet
                                        module</a></li>
                                    <li class="toctree-l3"><a class="reference internal" href="#module-core">Module
                                        contents</a></li>
                                </ul>
                            </li>
                            <li class="toctree-l2"><a class="reference internal" href="inference.html">inference
                                module</a></li>
                            <li class="toctree-l2"><a class="reference internal" href="training.html">training
                                module</a></li>
                            <li class="toctree-l2"><a class="reference internal" href="utils.html">utils package</a>
                            </li>
                        </ul>
                    </li>
                </ul>


            </div>
        </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">


        <nav aria-label="top navigation" class="wy-nav-top">

            <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
            <a href="index.html">ResNet Builder</a>

        </nav>


        <div class="wy-nav-content">

            <div class="rst-content">


                <div aria-label="breadcrumbs navigation" role="navigation">

                    <ul class="wy-breadcrumbs">

                        <li><a href="index.html">Docs</a> &raquo;</li>

                        <li><a href="modules.html">ResNet-builder</a> &raquo;</li>

                        <li>core package</li>


                        <li class="wy-breadcrumbs-aside">


                            <a href="_sources/core.rst.txt" rel="nofollow"> View page source</a>


                        </li>

                    </ul>


                    <hr/>
                </div>
                <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
                    <div itemprop="articleBody">

                        <div class="section" id="core-package">
                            <h1>core package<a class="headerlink" href="#core-package"
                                               title="Permalink to this headline">¶</a></h1>
                            <div class="section" id="submodules">
                                <h2>Submodules<a class="headerlink" href="#submodules"
                                                 title="Permalink to this headline">¶</a></h2>
                            </div>
                            <div class="section" id="module-core.data_loader">
                                <span id="core-data-loader-module"></span>
                                <h2>core.data_loader module<a class="headerlink" href="#module-core.data_loader"
                                                              title="Permalink to this headline">¶</a></h2>
                                <dl class="class">
                                    <dt id="core.data_loader.DataLoader">
                                        <em class="property">class </em><code class="sig-prename descclassname">core.data_loader.</code><code
                                            class="sig-name descname">DataLoader</code><span
                                            class="sig-paren">(</span><em class="sig-param">featurewise_center: bool =
                                        False</em>, <em class="sig-param">featurewise_std_normalization: bool =
                                        False</em>, <em class="sig-param">zca_whitening: bool = True</em>, <em
                                            class="sig-param">rotation_range: int = 30</em>, <em class="sig-param">width_shift_range:
                                        float = 0.2</em>, <em class="sig-param">height_shift_range: float = 0.2</em>,
                                        <em class="sig-param">zoom_range: float = 0.15</em>, <em class="sig-param">shear_range:
                                        float = 0.15</em>, <em class="sig-param">horizontal_flip: bool = True</em>, <em
                                            class="sig-param">validation_split: float = 0.3</em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#core.data_loader.DataLoader"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                            class="pre">object</span></code></p>
                                        <p>API to load and Augment Image Data</p>
                                        <dl class="method">
                                            <dt id="core.data_loader.DataLoader.from_common_dir">
                                                <code class="sig-name descname">from_common_dir</code><span
                                                    class="sig-paren">(</span><em class="sig-param">directory: str,
                                                target_size: Tuple[int, int], color_mode: str = 'rgb', batch_size: int =
                                                32</em><span class="sig-paren">)</span><a class="headerlink"
                                                                                          href="#core.data_loader.DataLoader.from_common_dir"
                                                                                          title="Permalink to this definition">¶</a>
                                            </dt>
                                            <dd><p>Takes the path to a directory &amp; generates batches of augmented
                                                data. Use this only if directory is common for
                                                both training data and validation data.</p>
                                                <p>Following should be the folder structure
                                                    Dir/sub_dir/<em>.jpeg –&gt; Dir/class/</em>.jpeg</p>
                                                <dl class="simple">
                                                    <dt>directory :str</dt>
                                                    <dd><p>Path of Image Directory. It should contain one subdirectory
                                                        per class.
                                                        Any PNG, JPG, BMP, PPM or TIF images inside each of the
                                                        subdirectories
                                                        directory tree will be included in the generator.</p>
                                                    </dd>
                                                    <dt>target_size: tuple, optional</span></dt>
                                                    <dd><p>The dimensions to which all images found will be resized, by
                                                        default (256,256)</p>
                                                    </dd>
                                                    <dt>color_mode: str, optional</span></dt>
                                                    <dd><p>One of “grayscale”, “rgb”, “rgba”.. Whether the images will
                                                        be converted to have 1, 3, or 4 channels,
                                                        by default “rgb”</p>
                                                    </dd>
                                                    <dt>batch_size: int, optional</span></dt>
                                                    <dd><p>Size of batches of images to be used, by default 32</p>
                                                    </dd>
                                                </dl>
                                                <p>ImageGenerator: Data generator to be used in fit_generator() Keras
                                                    API
                                                    x_test: Validation data
                                                    y_test: Validation labels</p>
                                                <p>Visit: <a class="reference external"
                                                             href="https://keras.io/preprocessing/image/#flow">https://keras.io/preprocessing/image/#flow</a>
                                                </p>
                                            </dd>
                                        </dl>

                                        <dl class="method">
                                            <dt id="core.data_loader.DataLoader.from_dir">
                                                <code class="sig-name descname">from_dir</code><span
                                                    class="sig-paren">(</span><em class="sig-param">directory: str</em>,
                                                <em class="sig-param">target_size: tuple = (256</em>, <em
                                                    class="sig-param">256)</em>, <em class="sig-param">color_mode: str =
                                                'rgb'</em>, <em class="sig-param">classes: int = None</em>, <em
                                                    class="sig-param">class_mode: str = 'categorical'</em>, <em
                                                    class="sig-param">batch_size: int = 32</em><span
                                                    class="sig-paren">)</span><a class="headerlink"
                                                                                 href="#core.data_loader.DataLoader.from_dir"
                                                                                 title="Permalink to this definition">¶</a>
                                            </dt>
                                            <dd><p>Takes the path to a directory &amp; generates batches of augmented
                                                data. Use this only if directory is separate for
                                                both training data and validation data. Therefore use this method to
                                                create training as well as validation
                                                data generator separately.</p>
                                                <dl class="simple">
                                                    <dt>directory: str</span></dt>
                                                    <dd><p>Path of Image Directory. It should contain one subdirectory
                                                        per class.
                                                        Any PNG, JPG, BMP, PPM or TIF images inside each of the
                                                        subdirectories
                                                        directory tree will be included in the generator.</p>
                                                    </dd>
                                                    <dt>target_size: tuple, optional</span></dt>
                                                    <dd><p>The dimensions to which all images found will be resized, by
                                                        default (256,256)</p>
                                                    </dd>
                                                    <dt>color_mode: str, optional</span></dt>
                                                    <dd><p>One of “grayscale”, “rgb”, “rgba”.. Whether the images will
                                                        be converted to have 1, 3, or 4 channels,
                                                        by default “rgb”</p>
                                                    </dd>
                                                    <dt>classes: list, optional</span></dt>
                                                    <dd><p>list of class subdirectories (e.g. [‘dogs’, ‘cats’]). If not
                                                        provided, the list of classes will be
                                                        automatically inferred from the subdirectory names/structure
                                                        under directory,
                                                        where each subdirectory will be treated as a different class,
                                                        by default None</p>
                                                    </dd>
                                                    <dt>class_mode: str, optional</span></dt>
                                                    <dd><p>One of “categorical”, “binary”, “sparse”, “input”, or None.
                                                        Determines the type of label arrays that are returned, by
                                                        default “categorical”</p>
                                                    </dd>
                                                    <dt>batch_size: int, optional</span></dt>
                                                    <dd><p>Size of the batches of data, by default 32</p>
                                                    </dd>
                                                </dl>
                                                <dl class="simple">
                                                    <dt>data_generator :</dt>
                                                    <dd><p>Data Loader for given data</p>
                                                    </dd>
                                                </dl>
                                                <p>Following should be the folder structure
                                                    Dir/sub_dir/<em>.jpeg –&gt; Dir/class/</em>.jpeg</p>
                                                <p>Visit: <a class="reference external"
                                                             href="https://keras.io/preprocessing/image/#flow_from_directory">https://keras.io/preprocessing/image/#flow_from_directory</a>
                                                </p>
                                            </dd>
                                        </dl>

                                    </dd>
                                </dl>

                            </div>
                            <div class="section" id="module-core.resnet">
                                <span id="core-resnet-module"></span>
                                <h2>core.resnet module<a class="headerlink" href="#module-core.resnet"
                                                         title="Permalink to this headline">¶</a></h2>
                                <dl class="function">
                                    <dt id="core.resnet.build_resnet_layer">
                                        <code class="sig-prename descclassname">core.resnet.</code><code
                                            class="sig-name descname">build_resnet_layer</code><span
                                            class="sig-paren">(</span><em class="sig-param">inputs</em>, <em
                                            class="sig-param">num_filters_in: int</em>, <em class="sig-param">depth:
                                        int</em><span class="sig-paren">)</span><a class="headerlink"
                                                                                   href="#core.resnet.build_resnet_layer"
                                                                                   title="Permalink to this definition">¶</a>
                                    </dt>
                                    <dd><p>Append desired no Residual layer with current Sequential layers.
                                        Input should be an instance of either Keras Sequential or Functional API with
                                        input shape.
                                        You may use output from this function to connect to a fully connected layer or
                                        any other layer.</p>
                                        <p>eg: Input layer –&gt; Conv2d layer –&gt; resnet_layer –&gt; FC</p>
                                        <dl class="simple">
                                            <dt>inputs: Tensor layer</span></dt>
                                            <dd><p>Input tensor from previous layer</p>
                                            </dd>
                                            <dt>num_filters_in: int</span></dt>
                                            <dd><p>Conv2d number of filters</p>
                                            </dd>
                                            <dt>depth: int</dt>
                                            <dd><p>Number of Residual layer to be appended with current Sequential
                                                layer</p>
                                            </dd>
                                        </dl>
                                        <blockquote>
                                            <div><p>Network with Residual layer appended.</p>
                                            </div>
                                        </blockquote>
                                    </dd>
                                </dl>

                                <dl class="function">
                                    <dt id="core.resnet.build_resnet_model">
                                        <code class="sig-prename descclassname">core.resnet.</code><code
                                            class="sig-name descname">build_resnet_model</code><span
                                            class="sig-paren">(</span><em class="sig-param">input_shape: Tuple[int, int,
                                        int], depth: int, num_classes: int</em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#core.resnet.build_resnet_model"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>ResNet Version 2 Model builder [b]</p>
                                        <p>Stacks of (1 x 1)-(3 x 3)-(1 x 1) BN-ReLU-Conv2D or also known as bottleneck
                                            layer.
                                            First shortcut connection per layer is 1 x 1 Conv2D. Second and onwards
                                            shortcut connection is identity.
                                            At the beginning of each stage, the feature map size is halved (down
                                            sampled) by a convolution layer with strides=2,
                                            while the number of filter maps is doubled. Within each stage, the layers
                                            have the same number filters and the
                                            same filter map sizes.</p>
                                        <dl class="simple">
                                            <dt>input_shape: tuple</span></dt>
                                            <dd><p>3D tensor shape of input image</p>
                                            </dd>
                                            <dt>depth: int</span></dt>
                                            <dd><p>Number of core Convolution layer. Depth should be 9n+2 (eg 56 or
                                                110), where n = desired depth</p>
                                            </dd>
                                            <dt>num_classes: int</span></dt>
                                            <dd><p>No of classes</p>
                                            </dd>
                                        </dl>
                                        <dl class="simple">
                                            <dt>Returns</dt>
                                            <dd><p>Keras Model </p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="function">
                                    <dt id="core.resnet.build_resnet_pretrained">
                                        <code class="sig-prename descclassname">core.resnet.</code><code
                                            class="sig-name descname">build_resnet_pretrained</code><span
                                            class="sig-paren">(</span><em class="sig-param">base_model: str =
                                        'ResNet50V2'</em>, <em class="sig-param">input_shape: Tuple[int</em>, <em
                                            class="sig-param">int</em>, <em class="sig-param">int] = None</em>, <em
                                            class="sig-param">no_classes: int = None</em>, <em class="sig-param">freeze:
                                        bool = True</em><span class="sig-paren">)</span><a class="headerlink"
                                                                                           href="#core.resnet.build_resnet_pretrained"
                                                                                           title="Permalink to this definition">¶</a>
                                    </dt>
                                    <dd><p>Build a ResNetV2 model using pretrained weights (eg. trained on imagenet).
                                        Use this if you want to use Transfer learning approach. For Fine-Tuning Layers
                                        can be freeze &amp; only Fully connected
                                        layer can be trained.</p>
                                        <dl class="simple">
                                            <dt>base_model: str, optional</span></dt>
                                            <dd><p>Base model to be used. Anything from ‘ResNet50V2’, ‘ResNet101V2’,
                                                ‘ResNet152V2’, by default ‘ResNet50V2’</p>
                                            </dd>
                                            <dt>input_shape: tuple</span></dt>
                                            <dd><p>3d tensor shape of images feeding as input</p>
                                            </dd>
                                            <dt>no_classes: int</span></dt>
                                            <dd><p>No of classes to classify</p>
                                            </dd>
                                            <dt>freeze: bool, optional</span></dt>
                                            <dd><p>Freeze all convolution layers and train only on Fully connected
                                                layer. Keep it true for transfer learning, by default True</p>
                                            </dd>
                                        </dl>
                                        <dl class="simple">
                                            <dt>Returns</dt>
                                            <dd><p>Keras Model </p>
                                            </dd>
                                        </dl>
                                        <dl class="simple">
                                            <dt>Raise ValueError</dt>
                                            <dd><p>“Base model should be from ‘ResNet50V2’, ‘ResNet101V2’,
                                                ‘ResNet152V2’</p>
                                            </dd>
                                        </dl>
                                        <dl class="simple">
                                            <dt>Note:</dt>
                                            <dd><p>Model will also include a Fully connected layer at end.</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="function">
                                    <dt id="core.resnet.build_resnet_pretrained_customized">
                                        <code class="sig-prename descclassname">core.resnet.</code><code
                                            class="sig-name descname">build_resnet_pretrained_customized</code><span
                                            class="sig-paren">(</span><em class="sig-param">base_model: str =
                                        'ResNet50V2'</em>, <em class="sig-param">input_shape: Tuple[int</em>, <em
                                            class="sig-param">int</em>, <em class="sig-param">int] = None</em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#core.resnet.build_resnet_pretrained_customized"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Build a ResNetV2 model using pretrained weights (eg. trained on imagenet).
                                        Use this if you want to use Transfer
                                        learning approach and desired fully connected layer. You have to append a fully
                                        connected layer at end w.r.t to
                                        Kearas Functional API.</p>
                                        <p>Example<br>
                                            X = build_resnet_pretrained_customized(input_shape = (224,224,3)<br>
                                            # Append FC layer<br>
                                            y = X.output<br>
                                            y = Flatten()(y)<br>
                                            y = Dense(10, activation=’softmax’)(y)<br>
                                            # Combining base model FC head model<br>
                                            model = Model(inputs=x.input, outputs=y)<br>
                                            # Freezing weights<br>
                                            for layer in base.layers:<br>
                                            &emsp; layer.trainable = False
                                    </dd>
                                </dl>
                                <dl class="simple">
                                    <dt>base_model: str, optional</span></dt>
                                    <dd><p>Base model to be used. Anything from ‘ResNet50V2’, ‘ResNet101V2’,
                                        ‘ResNet152V2’, by default ‘ResNet50V2’</p>
                                    </dd>
                                    <dt>input_shape: tuple</span></dt>
                                    <dd><p>3d tensor shape of images feeding as input</p>
                                    </dd>
                                </dl>
                                <dl class="simple">
                                    <dt>Returns</dt>
                                    <dd><p>Keras Model </p>
                                    </dd>
                                </dl>
                                <dl class="simple">
                                    <dt>Raise ValueError</dt>
                                    <dd><p>“Base model should be from ‘ResNet50V2’, ‘ResNet101V2’, ‘ResNet152V2’</p>
                                    </dd>
                                </dl>
                                <dl class="simple">
                                    <dt>Note:</dt>
                                    <dd><p>Model will not include a Fully connected layer at end at you have to add
                                        it</p>
                                    </dd>
                                </dl>
                                </dd></dl>

                                <dl class="function">
                                    <dt id="core.resnet.residual_block">
                                        <code class="sig-prename descclassname">core.resnet.</code><code
                                            class="sig-name descname">residual_block</code><span
                                            class="sig-paren">(</span><em class="sig-param">X</em>, <em
                                            class="sig-param">num_filters: int</em>, <em class="sig-param">stride: int =
                                        1</em>, <em class="sig-param">kernel_size: int = 3</em>, <em class="sig-param">activation:
                                        str = 'relu'</em>, <em class="sig-param">bn: bool = True</em>, <em
                                            class="sig-param">conv_first: bool = True</em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#core.resnet.residual_block"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd>
                                        <dl class="simple">
                                            <dt>X: Tensor layer</span></dt>
                                            <dd><p>Input tensor from previous layer</p>
                                            </dd>
                                            <dt>num_filters: int</span></dt>
                                            <dd><p>Conv2d number of filters</p>
                                            </dd>
                                            <dt>stride: int by default 1</span></dt>
                                            <dd><p>Stride square dimension</p>
                                            </dd>
                                            <dt>kernel_size: int by default 3</span></dt>
                                            <dd><p>COnv2D square kernel dimensions</p>
                                            </dd>
                                            <dt>activation: str by default ‘relu’</dt>
                                            <dd><p>Activation function to used</p>
                                            </dd>
                                            <dt>bn: bool by default True</dt>
                                            <dd><p>To use BatchNormalization</p>
                                            </dd>
                                            <dt>conv_first: bool by default True</span></dt>
                                            <dd><p>conv-bn-activation (True) or bn-activation-conv (False)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                            </div>
                            <div class="section" id="module-core">
                                <span id="module-contents"></span>
                                <h2>Module contents<a class="headerlink" href="#module-core"
                                                      title="Permalink to this headline">¶</a></h2>
                            </div>
                        </div>


                    </div>

                </div>
                <footer>

                    <div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">

                        <a accesskey="n" class="btn btn-neutral float-right" href="inference.html" rel="next"
                           title="inference module">Next <span class="fa fa-arrow-circle-right"></span></a>


                        <a accesskey="p" class="btn btn-neutral float-left" href="modules.html" rel="prev"
                           title="ResNet-builder"><span class="fa fa-arrow-circle-left"></span> Previous</a>

                    </div>


                    <hr/>

                    <div role="contentinfo">
                        <p>
                            &copy; Copyright 2020, Akash Desarda

                        </p>
                    </div>
                    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
                        href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a
                        href="https://readthedocs.org">Read the Docs</a>.

                </footer>

            </div>
        </div>

    </section>

</div>


<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
    });
</script>


</body>
</html>